{"version":3,"sources":["methods/ajax/index.ts","methods/constant/index.ts","assets/image/logo.svg","pages/LogIn/index.tsx"],"names":["axios__WEBPACK_IMPORTED_MODULE_0__","__webpack_require__","axios__WEBPACK_IMPORTED_MODULE_0___default","n","_history_index__WEBPACK_IMPORTED_MODULE_1__","_constant_index__WEBPACK_IMPORTED_MODULE_2__","ajax","axios","create","baseURL","timeout","headers","t-app-id","t-app-secret","interceptors","request","use","config","xToken","localStorage","getItem","TOMATO_ALARM_CLOCK_X_TOKEN","concat","error","Promise","reject","response","setItem","status","history","replace","d","__webpack_exports__","module","exports","p","LogIn","_ref","_useState","useState","_useState2","Object","_Users_madao_production_tomato_alarm_clock_node_modules_babel_preset_react_app_node_modules_babel_runtime_helpers_esm_slicedToArray__WEBPACK_IMPORTED_MODULE_6__","isLogIn","setIsLogIn","_useState3","_useState4","userName","setUserName","_useState5","_useState6","password","setPassword","_useState7","_useState8","passwordConfirmation","setPasswordConfirmation","canLogIn","antd_es_message__WEBPACK_IMPORTED_MODULE_5__","canSignUp","logIn","post","account","then","catch","err","errors","data","message","signUp","password_confirmation","react__WEBPACK_IMPORTED_MODULE_7___default","a","createElement","className","src","logo","alt","antd_es_input__WEBPACK_IMPORTED_MODULE_3__","onChange","e","target","value","Password","type","Fragment","antd_es_button__WEBPACK_IMPORTED_MODULE_1__","block","ghost","onClick"],"mappings":"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","file":"static/js/6.4f724ab3.chunk.js","sourcesContent":["import axios from 'axios';\nimport history from '../history/index';\nimport { TOMATO_ALARM_CLOCK_X_TOKEN } from '../constant/index';\n\nconst appId: string = 'XTrcPmPP6mK73ZgLHoXfnRef';\nconst appSecret: string = 'FNhsEEYYNvPK4xt5nLG9Qfv9';\n\nconst ajax = axios.create({\n  baseURL: 'https://gp-server.hunger-valley.com',\n  timeout: 2000,\n  headers: {\n    't-app-id': appId,\n    't-app-secret': appSecret\n  }\n});\n\najax.interceptors.request.use(config => {\n  const xToken = localStorage.getItem(TOMATO_ALARM_CLOCK_X_TOKEN)\n  if(xToken){\n      config.headers['Authorization'] = `Bearer ${xToken}`\n  }\n  return config;\n}, error => Promise.reject(error));\n\najax.interceptors.response.use(response => {\n  if(response.headers['x-token']){\n    localStorage.setItem(TOMATO_ALARM_CLOCK_X_TOKEN, response.headers['x-token'])\n  }\n  return response;\n}, error => {\n  if (error.response.status === 401) {\n    history.replace('/login')\n  }\n  return Promise.reject(error)\n});\n\nexport default ajax;\n","const TOMATO_ALARM_CLOCK_X_TOKEN: string = 'TOMATO_ALARM_CLOCK_X_TOKEN';\n\nexport {\n  TOMATO_ALARM_CLOCK_X_TOKEN\n}","module.exports = __webpack_public_path__ + \"static/media/logo.f4002783.svg\";","import React, { useState } from 'react';\nimport { RouteComponentProps } from 'react-router-dom';\nimport './style.scss';\nimport logo from '../../assets/image/logo.svg';\nimport { Input, Button, message } from 'antd';\nimport ajax from '../../methods/ajax/index';\n\nconst LogIn: React.FC<RouteComponentProps> = ({history}) => {\n\n  const [isLogIn, setIsLogIn] = useState(true);\n  const [userName, setUserName] = useState('');\n  const [password, setPassword] = useState('');\n  const [passwordConfirmation, setPasswordConfirmation] = useState('');\n\n  const onSubmit = () => {\n    if (isLogIn && canLogIn()) {\n      logIn()\n    } else if (!isLogIn && canSignUp()) {\n      signUp()\n    }\n  }\n\n  const canLogIn = (): boolean => {\n    if (!userName) {\n      message.error('请输入用户名');\n      return false;\n    }\n    if (!password) {\n      message.error('请输入密码');\n      return false;\n    }\n    return true;\n  }\n\n  const canSignUp = (): boolean => {\n    if (!userName) {\n      message.error('请输入用户名');\n      return false;\n    }\n    if (!password) {\n      message.error('请输入密码');\n      return false;\n    }\n    if (password !== passwordConfirmation) {\n      message.error('两次输入的密码不一致');\n      return false;\n    }\n    return true;\n  }\n\n  const logIn = () => {\n    ajax.post('/sign_in/user', {account: userName, password})\n      .then(() => {\n        history.replace('/');\n      })\n      .catch(err => {\n        try {\n          const {response: {data: {errors}}} = err;\n          message.error(errors)\n        } catch (error) {\n          message.error(err.message);\n        }\n      })\n  }\n\n  const signUp = () => {\n    ajax.post('/sign_up/user', {\n      account: userName,\n      password,\n      password_confirmation: passwordConfirmation\n    })\n      .then(() => {\n        history.replace('/');\n      })\n      .catch(err => {\n        const {response: {data: {errors}}} = err;\n        message.error(errors.account[0] ? '该用户已存在' : err.message);\n      })\n  }\n  const classPrefix = 'log-in';\n\n  return (\n    <div className={`${classPrefix}_container`}>\n      <div className={`${classPrefix}_content`}>\n        <img src={logo} alt=\"logo\" className={`${classPrefix}_logo`}/>\n        <h3 className={`${classPrefix}_title`}>{isLogIn ? 'Log in' : 'Sign up'}</h3>\n\n        <div className={`${classPrefix}_input-area`}>\n          <h5 className={`${classPrefix}_input-label`}>Username</h5>\n          <Input\n            className={`${classPrefix}_input`}\n            onChange={(e) => {setUserName(e.target.value)}} />\n          <h5 className={`${classPrefix}_input-label`}>Password</h5>\n          <Input.Password\n            className={`${classPrefix}_input`} type='password'\n            onChange={(e) => {setPassword(e.target.value)}} />\n          {!isLogIn && (\n            <React.Fragment>\n              <h5 className={`${classPrefix}_input-label`}>Confirm Password</h5>\n              <Input.Password\n                className={`${classPrefix}_input`} type='password'\n                onChange={(e) => {setPasswordConfirmation(e.target.value)}} />\n            </React.Fragment>\n          )}\n        </div>\n\n        <Button\n          block ghost\n          className={`${classPrefix}_button`} onClick={onSubmit}>\n          {isLogIn ? 'Log in' : 'Sign up'}\n        </Button>\n\n        <p className={`${classPrefix}_tip`}>\n          {\n            isLogIn ? (\n              <React.Fragment>\n                新用户？ <span onClick={() => {setIsLogIn(false)}}>Sign up</span>\n              </React.Fragment>\n            ) : (\n              <React.Fragment>\n                老用户？ <span onClick={() => {setIsLogIn(true)}}>Log in</span>\n              </React.Fragment> \n            )\n          }\n        </p>\n      </div>\n    </div>\n  )\n}\n\nexport default LogIn;"],"sourceRoot":""}